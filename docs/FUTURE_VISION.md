# Идеи для развития ОС RE36 (VLSMC Bare-Metal)

Данный документ описывает перспективные направления для дальнейшего развития нашей операционной системы. ОС уже обладает многозадачностью, кольцами защиты (Ring 0 / 3), поддержкой файловой системы FAT16, драйверами клавиатуры и таймера, а также базовой инфраструктурой загрузки ELF-бинарников. Ниже представлены идеи, которые позволят превратить проект в полноценную и функциональную систему.

## 1. Развитие графики и оконной системы (GUI / Window Manager)

Сейчас система работает в текстовом режиме VGA (80x25). Основной вектор развития пользовательского интерфейса:
- **VESA VBE / Переключение в графический режим:** Реализация драйвера для переключения видеокарты в графический режим (например, 1024x768x32).
- **Собственный фреймбуфер (Double Buffering):** Написание базовых примитивов отрисовки (пиксели, линии, прямоугольники, текст с собственным шрифтом), защита от мерцания (tearing).
- **Оконный менеджер (Compositor):** Создание оконной подсистемы, где каждое приложение сможет запрашивать свой буфер (Shared Memory) и рисовать в нём, а Compositor в фоне будет собирать экраны вместе с курсором мыши. Это позволит уйти от интерфейса командной строки к подобию системы VLSMC, о которой упоминалось ранее.

## 2. Поддержка новых устройств и шины PCI

Каркас PCI-шины уже написан, но он умеет только перечислять устройства. Что можно сделать:
- **Драйвер мыши (PS/2):** Необходим для графического интерфейса. Мышь, как и клавиатура, подключается к контроллеру 8042 (IRQ 12).
- **Драйвер Realtek RTL8139 / Intel E1000 (Сетевые карты):** Добавление первого серьезного PCI-устройства. Это откроет путь к написанию сетевого стека (TCP/IP).
- **AHCI / SATA:** FAT16 работает на эмулируемом IDE (ATA PIO). Переход на AHCI/DMA значительно ускорит чтение файлов и позволит работать на современном железе.

## 3. Сети и Интернет (Networking Stack)

Базовая сеть — огромный шаг для любой любительской ОС.
- **Ethernet Layer:** Отправка и прием сырых Layer-2 кадров.
- **ARP & IPv4:** Резолвинг MAC-адресов и базовая маршрутизация.
- **UDP & TCP:** Написание стейт-машины для TCP.
- **Сокеты (Sockets):** Расширение системных вызовов (`sys_socket`, `sys_bind`, `sys_send`, `sys_recv`), чтобы пользовательские приложения могли скачивать файлы или общаться по локальной сети.

## 4. Расширение файловых систем и VFS

В данный момент ОС жестко привязана к FAT16.
- **VFS (Virtual File System):** Абстрактный слой поверх фаловых систем, который позволит монтировать устройства в древовидную структуру (как в Unix: `/dev/sda1`, `/mnt/cdrom`).
- **FAT32 и ext2:** Поддержка более современных форматов для работы с накопителями больше 2 или 4 ГБ.
- **Device Files:** Поддержка символьных устройств (character devices: `/dev/null`, `/dev/tty`, `dev/random`) для упрощения работы с I/O из юзерспейса.

## 5. Системная библиотека (libc) и портирование софта

Текущая библиотека `libc.h` (и `libc.cpp`) написана нами с нуля и содержит только самый базовый минимум.
- **Улучшение `newlib`:** Портирование полноценной стандартной библиотеки C.
- **Поддержка POSIX:** Приближение наших системных вызовов к стандарту POSIX (полноценные `fork()`, `execve()`, `signal()`, `waitpid()`).
- **Портирование Doom / GCC:** Если наша ОС сможет поддержать POSIX-сисколлы (чтение файлов, выделение памяти `sbrk/mmap`), мы сможем запустить реальные сторонние приложения без их изменения. Запуск DOOM — святой Грааль разработчиков ОС.

## 6. Звук (Audio)

- **PC Speaker:** Простейший способ добавить звуки (пиканье).
- **Intel High Definition Audio / AC97 (через PCI):** Написание драйвера для воспроизведения PCM аудио-потоков. Позволит воспроизводить WAV файлы форматов 16-bit 44100Hz.

## 7. IPC, Службы и User-Space Драйверы (Микроядерность)

Мы уже заложили `event_channel.cpp` для IPC.
- В будущем драйверы (например, файловая система, сетевой стек, драйверы ФС) можно вынести из Ядра `Ring 0` в Пользовательское пространство `Ring 3` (User-Space Drivers), превращая нашу ОС в полноценное микроядро.
- Приложение будет посылать сообщение "Прочитай блок 5" процессу-драйверу ATA через IPC, получая ответ. Это радикально повысит безопасность системы (падение драйвера не убивает ядро).

## Заключение
Наиболее логичным и "видимым" следующим шагом будет **Пункт 1 (VESA Графика + PS/2 Мышь)** или **Полировка файловой системы (VFS + Чтение каталогов из Shell)**. Создание окон и взаимодействие с ними мышью производит наибольший "WOW-эффект" от написания собственной ОС.
