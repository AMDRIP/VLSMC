# Руководство: Запуск VLSMC на реальном железе

Для запуска операционной системы на настоящем ПК (не в эмуляторе) необходимо подготовить загрузочный носитель (USB-флешку или HDD). Поскольку VLSMC использует классический двухстадийный загрузчик для x86, процесс требует аккуратной записи посекторно.

## 1. Требования к железу
- **Процессор**: x86 (Intel/AMD) с поддержкой 32-битного режима.
- **BIOS**: Режим **Legacy BIOS** (или CSM в UEFI). Проект пока не поддерживает нативный UEFI/GOP.
- **Носитель**: USB-флешка объемом от 128 МБ (рекомендуется FAT16).

## 2. Способы создания образа

### Способ А: Прямая запись образа дискеты (Floppy)
Если ваш BIOS поддерживает эмуляцию Floppy через USB (USB-FDD):
1. Соберите систему через `build.sh` (получите `disk.img`).
2. Запишите образ на флешку через `dd` (Linux/WSL) или Rufus (Windows):
   `sudo dd if=disk.img of=/dev/sdX bs=512 status=progress`
   *Где `/dev/sdX` — ваша флешка.*

### Способ Б: Создание загрузочного жесткого диска (HDD/USB-HDD)
Это более надежный способ для современных ПК:
1. **Разметка**: Создайте на флешке один раздел FAT16 и пометьте его как активный (Bootable).
2. **Загрузчик**: Запишите `bootloader.bin` в MBR (первый сектор) носителя.
   > [!WARNING]
   > Будьте осторожны! Ошибка в `of=/dev/sdX` может уничтожить данные на вашем системном диске.
3. **Копирование**: Скопируйте файлы `STAGE2.BIN` и `KERNEL.BIN` в корень созданного раздела.

## 3. Использование `grub-mkrescue` (ISO)
Если вы хотите создать ISO-образ для записи на CD/DVD или эмуляции:
1. Установите `grub-pc-bin` и `xorriso`.
2. Создайте структуру директорий:
   ```bash
   mkdir -p iso/boot/grub
   cp KERNEL.BIN iso/boot/
   ```
3. Создайте конфиг `iso/boot/grub/grub.cfg`:
   ```grub
   menuentry "VLSMC" {
       multiboot /boot/KERNEL.BIN
       boot
   }
   ```
   *Примечание: это требует поддержки протокола Multitboot в вашем ядре.*

## 4. Настройка BIOS
1. Вставьте флешку в выключенный ПК.
2. Войдите в BIOS (обычно `F2`, `F10`, `Del`).
3. Включите **Legacy Support** или **CSM**.
4. Отключите **Secure Boot**.
5. Установите USB-носитель первым в очереди загрузки (Boot Priority).

## 5. Возможные проблемы
- **Черный экран**: Вероятно, BIOS не смог найти загрузочную сигнатуру `0xAA55` или не поддерживает выбранный режим эмуляции.
- **Reboot Loop**: Ошибка при переходе в Protected Mode или несовместимость с ACPI. Попробуйте отключить в BIOS лишнюю периферию.
- **No Disk Found**: Проверьте, что раздел помечен как `Active` (флаг 0x80 в таблице разделов).
